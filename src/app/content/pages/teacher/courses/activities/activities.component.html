<!-- LEYENDA -->
<div class="m-alert m-alert--icon m-alert--air m-alert--square alert alert-dismissible m--margin-bottom-30" role="alert">
   <div class="m-alert__icon">
      <i class="flaticon-exclamation m--font-brand"></i>
   </div>
   <div class="m-alert__text">
      La realización de actividades entrega al estudiante la oportunidad de obtener puntos extra al realizarla
      actividad propuesta por el profesor.
      <br><br>
      Algunas características de las actividades son:
      <ul>
         <li>Corresponden a actividades que el profesor puede entregar en hoja de papel o proyectar, como por ejemplo,
            el ejercicio de una guía o prueba.
         </li>
         <li>Pueden ser realizadas de maneral grupal o individual.
         </li>
         <li>Los puntos entregados no cuentan al momento de calcular el avance de la meta.</li>
      </ul>

   </div>
</div>
<!-- FIN LEYENDA -->

<div class="m-portlet m-portlet--mobile">
   <!-- CARD HEADER -->
   <div class="m-portlet__head">
      <!-- TITULO HEADER -->
      <div class="m-portlet__head-caption">
         <div class="m-portlet__head-title">
            <h3 class="m-portlet__head-text">
               Actividades
            </h3>
         </div>
      </div>
      <!-- FIN TITULO -->
      <!-- ACCIONES HEADER -->

      <!-- FIN ACCIONES HEADER -->
   </div>
   <!-- FIN CARD HEADER -->

   <!-- CARD BODY -->
   <div class="m-portlet__body">

      <!-- SECCIÓN DE FILTRO Y BUSQUEDA -->
      <div class="m-form m-form--label-align-right m--margin-top-20 m--margin-bottom-30">
         <form [formGroup]="filterForm" (ngSubmit)="filterItems(filterForm.value)">
            <div class="row align-items-center">


               <div class="col-xl-9 order-2 order-xl-1" style="display:inline;">

                  <!-- INICIA FORMULARIO -->
                  <!-- <form [formGroup]="filterForm"> -->
                  <div class="form-group m-form__group row align-items-center">
                     <div class="col-md-4">
                        <div class="m-form__group m-form__group--inline">
                           <div class="m-form__label">
                              <label>Modalidad:</label>

                           </div>
                           <div class="m-form__control">
                              <select formControlName="mode" class="form-control m-bootstrap-select" id="m_form_type">
                                 <option value="">Todas</option>
                                 <option [ngValue]="1">Individual</option>
                                 <option [ngValue]="2">Grupal</option>
                              </select>
                           </div>
                        </div>
                        <div class="d-md-none m--margin-bottom-10"></div>
                     </div>
                     <div class="col-md-4">
                        <div class="m-form__group m-form__group--inline">
                           <div class="m-form__label">
                              <label class="m-label m-label--single">Estado:</label>
                           </div>
                           <div class="m-form__control">
                              <select formControlName="status" class="form-control m-bootstrap-select" id="m_form_type">
                                 <option value="">Todos</option>
                                 <option [ngValue]="true">Abierta</option>
                                 <option [ngValue]="false">Cerrada</option>
                              </select>
                           </div>
                        </div>
                        <div class="d-md-none m--margin-bottom-10"></div>
                     </div>
                     <!--
                     <div class="col-md-4">
                        <div class="m-input-icon m-input-icon--left">

                           <input formControlName="search" type="text" maxLength="25" class="form-control m-input"
                              placeholder="">

                           <span class="m-input-icon__icon m-input-icon__icon--left">
                              <span>
                                 <i class="la la-search"></i>
                              </span>
                           </span>
                        </div>
                     </div>-->
                  </div>
                  <!-- </form> -->

               </div>
               <div class="col-xl-3 order-1 order-xl-2 m--align-right">
                  <button type="submit" style="color: #ffffff" class="btn btn-primary m-btn m-btn--custom m-btn--air m-btn--pill"
                     [disabled]="filterForm.value.mode === f_mode && filterForm.value.status === f_status">
                     <span>
                        <span>Filtrar</span>
                     </span>
                  </button>
                  <button type="button" (click)="createActivity()" style="color: #ffffff" class="btn btn-primary m-btn m-btn--custom m-btn--air m-btn--pill">
                     <span>
                        <span>Crear Actividad</span>
                     </span>
                  </button>
                  <div class="m-separator m-separator--dashed d-xl-none"></div>
               </div>
            </div>
         </form>
      </div>
      <!-- FIN FILTRO/BUSQUEDA -->

      <!-- TABLE -->
      <div class="m-datatable m-datatable--default m-datatable--brand m-datatable--loaded">

         <table class="cw-table">
            <thead>
               <tr>
                  <th class="center">#</th>
                  <th>Actividad</th>
                  <th>Modalidad</th>
                  <th>Clase</th>
                  <th>Modulo</th>
                  <th>Ganadores</th>
                  <th>Estado</th>
                  <th>Fecha de Creación</th>
                  <th>Fecha de Actualización</th>
                  <th class="center">Acciones</th>
               </tr>
            </thead>

            <tbody>
               <tr *ngFor="let activity of data_activities; let i=index">
                  <td>{{i+1}}</td>
                  <td class="nowrap">{{activity.name}}</td>
                  <td>{{activity.mode == 1 ? 'individual' : 'grupal'}}</td>
                  <td>{{activity.lesson}}</td>
                  <td>{{activity.module}}</td>
                  <td style="text-align: center">

                     <!-- {{activity.winners}} -->
                     <div style="width: 30%; cursor: pointer; margin: auto;" (click)="changeWinnerStatus(student)">
                        <img *ngIf="activity.winners; else blank" src="assets/images/checked.svg" alt="">
                        <ng-template #blank>
                           <img src="assets/images/blank.svg" alt="">
                        </ng-template>
                     </div>

                     <a (click)="updateActivity(activity)" class="m-portlet__nav-link btn m-btn m-btn--hover-accent m-btn--icon m-btn--icon-only m-btn--pill">
                        <i class="la la-info-circle"></i>
                     </a>

                  </td>
                  <td class="nowrap">
                     <span style="width: 100%">
                        <span class="m-badge m-badge--dot" [ngClass]="(activity.status)?'m-badge--success':'m-badge--danger'"></span>
                        &nbsp;
                        <span class="m--font-bold" [ngClass]="(activity.status)?'m--font-success':'m--font-danger'">
                           {{activity.status ? 'Completada': 'Pendiente'}}</span>
                     </span>

                  </td>
                  <td>{{activity.created_at}}</td>
                  <td>{{activity.updated_at}}</td>
                  <td>
                     <span style="overflow:visible;position:relative;width:110px;display:block;text-align:center">

                        <a (click)="updateActivity(activity)" class="m-portlet__nav-link btn m-btn m-btn--hover-accent m-btn--icon m-btn--icon-only m-btn--pill">
                           <i class="la la-play"></i>
                        </a>

                        <a (click)="updateActivity(activity)" class="m-portlet__nav-link btn m-btn m-btn--hover-accent m-btn--icon m-btn--icon-only m-btn--pill">
                           <i class="la la-edit"></i>
                        </a>
                        <!-- <a (click)="deleteActivity(activity.id_activity)" class="m-portlet__nav-link btn m-btn m-btn--hover-danger m-btn--icon m-btn--icon-only m-btn--pill">
                           <i class="la la-trash"></i>
                        </a> -->

                        <a [swal]="deleteSwal" class="m-portlet__nav-link btn m-btn m-btn--hover-danger m-btn--icon m-btn--icon-only m-btn--pill">
                           <i class="la la-trash"></i>
                        </a>

                        <!-- <swal #deleteSwal title="¿Está seguro?" text="¿seguro desea eliminar la actividad?" (confirm)="deleteFile(file)"
                        type="warning" [showCancelButton]="true" [focusCancel]="true" confirmButtonText="Si, eliminar" cancelButtonText="Cancelar" >
                        </swal> -->

                        <swal #deleteSwal (confirm)="deleteActivity(activity.id_activity)" [options]="SWAL_DELETE_ACTIVITY"></swal>
                        <swal #successSwal [options]="SWAL_SUCCESS_DELETE_ACTIVITY"></swal>
                     </span>
                  </td>
               </tr>
            </tbody>
         </table>




         <div class="m-datatable__pager m-datatable--paging-loaded clearfix">
            <ul class="m-datatable__pager-nav">
               <li (click)="getUsersPage(0)">
                  <a title="Primera" class="m-datatable__pager-link m-datatable__pager-link--first" [ngClass]="{'m-datatable__pager-link--disabled': (from < page_size)}">
                     <i class="la la-angle-double-left"></i>
                  </a>
               </li>
               <li (click)="getUsersFrom(-page_size)">
                  <a title="Anterior" class="m-datatable__pager-link m-datatable__pager-link--prev" [ngClass]="{'m-datatable__pager-link--disabled': (from < page_size)}">
                     <i class="la la-angle-left"></i>
                  </a>
               </li>
               <!--
                  <li>
                     <a class="m-datatable__pager-link m-datatable__pager-link-number" [ngClass]="{'m-datatable__pager-link--active'}">1</a>
                  </li>
                  <li>
                     <a class="m-datatable__pager-link m-datatable__pager-link-number">2</a>
                  </li>-->
               <li *ngFor="let _page of total_pages | fillArray" (click)="getUsersPage((page-1)*page_size)">
                  <a class="m-datatable__pager-link m-datatable__pager-link-number" [ngClass]="{'m-datatable__pager-link--active': _page == page}">{{_page}}</a>
               </li>
               <li (click)="getUsersFrom(+page_size)">
                  <a class="m-datatable__pager-link m-datatable__pager-link--next" [ngClass]="{'m-datatable__pager-link--disabled': ((from/page_size)+1)==total_pages}">
                     <i class="la la-angle-right"></i>
                  </a>
               </li>
               <li (click)="getUsersPage(page_size*(total_pages-1))">
                  <a class="m-datatable__pager-link m-datatable__pager-link--next" [ngClass]="{'m-datatable__pager-link--disabled': ((from/page_size)+1)==total_pages}">
                     <i class="la la-angle-double-right"></i>
                  </a>
               </li>
            </ul>

            <!-- INFO DE LA TABLA -->
            <div class="m-datatable__pager-info">
               <!--
                  <select class="m-datatable__pager-size" data-width="170px" data-selected="10">
                     <option value>seleccione tamaño de página</option>
                     <option value="10">10</option>
                     <option value="50">50</option>
                     <option value="100">100</option>
                  </select>-->
               <form [formGroup]="filterForm" style="display:inline;">
                  <select formControlName="page_size" class="m-datatable__pager-size" style="width:160px" (change)="kisa()">>
                     <option value="20">20</option>
                     <option value="50">50</option>
                  </select>
               </form>

               <!-- <div class="dropdown bootstrap-select m-datatable__pager-size dropup" style="width: 70px">

                     <button type="button" class="btn dropdown-toggle btn-light" data-togle="dropdown" role="button" title="Select page size" aria-expanded="false">
                        <div class="filter-option">
                           <div class="filter-option-inner">10</div>
                        </div>
                        <span class="bs-caret">
                           <span class="caret"></span>
                        </span>
                     </button>
                  </div>
                  <div class="dropdown-menu" role="combobox" x-placement="top-start" style="max-height: 756.318px; overflow: hidden; min-height: 130px; position: absolute; will-change: transform; top: 0px; left: 0px; transform: translate3d(0px, -3px, 0px);">
                     <div class="inner show" role="listbox"></div>
                  </div> -->
               <span class="m-datatable__pager-detail">Mostrando {{total_items ? ((page-1)*page_size + 1) : 0}}
                  -
                  {{(page_size*page > total_items) ? total_items : (page_size*page)}} de {{total_items}}
                  actividades</span>
            </div>
         </div>
      </div>

   </div>
</div>
